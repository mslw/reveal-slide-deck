<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        
        <title>Research Data Management: SFB1451 PI Workshop</title>
        
        <link rel="stylesheet" href="reveal.js/dist/reset.css">
        <link rel="stylesheet" href="reveal.js/dist/reveal.css">
        <link rel="stylesheet" href="reveal.js/dist/theme/beige.css">
        
        <!-- Theme used for syntax highlighted code -->
        <link rel="stylesheet" href="reveal.js/plugin/highlight/monokai.css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
        <link rel="stylesheet" href="assets/fontawesome/css/all.css">
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                
                <section data-markdown>
                    <textarea data-template>
# Research Data Management
## SFB1451 PI Workshop
Part 2: the moving parts
                    </textarea>
                </section>

                <section data-markdown>
                    <textarea data-template>
### Outline
- Collect and communicate: an overview
  - About catalog
  - About metadata
  - About data
  - About DataLad
- Topics mailed in
- Action items
                    </textarea>
                </section>

                <section data-markdown>
                    <textarea data-template>
## Collect & communicate
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
This is a catalog page for a dataset:

![Catalog page](images/pi-workshop/catalog-dataset.png)


- The catalog *per se* is not the main goal
- But it communicates that we achieved our goals



It was generated from metadata such as this:
```json
{
    "dataset_id": "88cbc6bc-cce5-45b7-9066-4e3650fbb5ea",
    "dataset_version": "8ef196a7c454cae6f260ac3071d716f5955133fa",
    "type": "dataset",
    "name": "Externally Cued Movements",
    "short_name": "Data for: Stimulus transformation into motor action: dynamic graph analysis reveals a posterior-to-anterior shift in brain network communication of older subjects",
    "description": "This dataset includes EEG recordings of 18 younger healthy subjects (18-35yrs) and 24 older healthy subjects (60+yrs) while they performed a visually cued finger tapping task. The task includes a visually-cued index finger tapping task and a vision-only control condition.",
    "doi": "https://doi.org/10.26165/JUELICH-DATA/T1PKNZ",
    "url": ["https://github.com/jsheunis/Externally-Cued-Movements"],
    "license": {
        "name": "CC-BY 4.0 - Attribution",
        "url": "https://creativecommons.org/licenses/by/4.0/"
    },
    "authors": [
        {
            "givenName": "Nils",
            "familyName": "Rosjat",
        },
        {
            "givenName": "Bin A.",
            "familyName": "Wang"
        },
        {
            "givenName": "Liqing",
            "familyName": "Liu"
        },
        {
            "givenName": "Gereon R.",
            "familyName": "Fink",
        },
        {
            "givenName": "Silvia",
            "familyName": "Daun",
        }
    ],
    "keywords": ["Young", "Old", "Human", "EEG", "Finger tapping", "Visual cues", "Vision-only control", "extstim"],
    "funding": [
        {
            "name": "German Research Foundation (DFG)",
            "identifier": "DFG-SFB 1451 (Project-ID 431549029)",
            "description": "-"
        },
	{
	    ...
	}
    ],
    "publications": [
        {
            "type": "ScholarlyArticle",
            "title": "Stimulus transformation into motor action: Dynamic graph analysis reveals a posterior-to-anterior shift in brain network communication of older subjects",
            "doi": "https://doi.org/10.1002/hbm.25313",
            "datePublished": 2021,
            "publicationOutlet": "Human Brain Mapping",
            "authors": [...]
        }
    ],
    "subdatasets": [],
    "extractors_used": [ ... ],
    "additional_display": [...],
    "children": [...],
}
```
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
This metadata:
- could be generated by hand
- ... or from a DataLad dataset:


Starting with a folder of things, `my-project`

Make it a dataset:
```zsh
cd my-project
datalad create --force .
datalad save
```

Extract metadata:

```zsh
datalad meta-extract -d . metalad_core
datalad meta-extract -d . datacite_gin
```
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
### Metadata
You can go as far as you want:
- dataset metadata (id, version, subdatasets)
- file metadata (names, types, sizes)
- study metadata (authors, description, funding)
- domain specific metadata (anything)


In DataLad datasets:
- metadata is generated based on dataset contents
- a function which produces metadata is called *extractor*
  - several extractors are provided
  - custom ones can be written
- extractors can be created and improved upon over time
  - no need to do all at once


#### Dataset metadata
- dataset id, version, subdatasets
- comes from being a DataLad dataset

<i class="fa-solid fa-robot"></i>


#### File metadata
- names, types, sizes
- comes from files being there

<i class="fa-solid fa-robot"></i>


#### Study metadata
- authors, description, funding
- can come from standardised text files, like CITATION.cff

<i class="fa-solid fa-robot"></i>/<i class="fa-solid fa-users"></i>


#### Domain specific metadata
- tasks, data modalities, ...
- can come from following a standard
- extractors: BIDS, custom extractors

<i class="fa-solid fa-robot"></i>/<i class="fa-solid fa-users"></i>


#### What is SFB-specific metadata?

![What is SFB metadata](images/pi-workshop/sfb-metadata.png)
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
### From catalog to data?

![Download with DataLad](images/pi-workshop/catalog-download.png)


#### Library metaphor:
- The catalog only points to a shelf
  - The shelf may be in a public section (you can grab the book)
  - The shelf may be in a closed-off library section (you talk to librarian)
  - The book might be no longer on the shelf


#### Beyond the catalog
- Publish catalog entry only
- Publish lean dataset
  - file placeholders
  - lightweight files (`README`, code)
  - machine-readable availability record
- Publish data contents
  - Publically (datalad get)
  - Privately (datalad get + credentials)
  - Intramurally (datalad get + physical access)
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
### Ok, so what *is* DataLad?

Two pillars (reductionist view):
- Version control
- Distribution


#### Version control
- records of what changed, when and why
- only the latest file version in the working directory, old versions cleverly stashed away
- separates file content and file identity


#### Distribution
- Keep (multilple) copies up to date
- Complete decentralization
- Work with known services (Dracoon, Sciebo, GIN, GitHub, AWS, ...)


Almost all of this is optional from the PoV of the catalog!
                    </textarea>
                </section>

                <section data-markdown>
                    <textarea data-template>
## Mailed-in topics
                    </textarea>
                </section>
                
                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
Common data formats?


![](images/pi-workshop/bids-logo-250.png)

![](images/pi-workshop/bids-layout.png)


#### About BIDS
- Rules (MUST, SHOULD, CAN...)
  - for file names, data formats, folder structure, required metadata
  - many good rules for tabular data
- Scope
    - started with human MRI
    - now covers: MRI, MEG, (i)EEG, PET, Microscopy, Physiological, Behavioral, Genetic descriptors
    - more extensions WIP


- BIDS is well defined
  - [bids.neuroimaging.io](https://bids.neuroimaging.io)
  - [bids-specification.readthedocs.io](https://bids-specification.readthedocs.io)
- BIDS is (increasingly) broadly used


#### Open question

- What would be exceptions to BIDS?
- General frameworks exist
  - [Data packages](http://dataprotocols.org/data-packages/)
  - [Research compendia](https://the-turing-way.netlify.app/reproducible-research/compendia.html)
  - ECR RDM course - [Structuring data](https://psychoinformatics-de.github.io/rdm-course/02-structuring-data)
- Inhomogeniety comes at a cost


#### Take-away
- BIDS is good
- Standardisation is very helpful
- But better to have some data then no data
  - Track first, then think about standardisation
  - Capture immediately, curate perpetually
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
Sharing non-anonymised data (e.g.) raw fMRI images within CRC


- Essentially dependednt on the scope of consent
- Only the project owner can decide
- Modes of operation predate CRC
- Most practical advice will come from projects who acquire data
- Is the SFB the data controller?
                    </textarea>
                </section>


                <section data-markdown data-separator-vertical="^\n\n">>
                    <textarea data-template>
Easy identification of subgroups

Cross-correlation of different modalities


- This is a metadata question
  - also relevant for computational modelling
- have the subjects gone through Z03?
  - if so, lots of metadata; Z03 can provide mapping
- what is the common vocabulary? where do we put it?
  - BIDS is capable of storing additional metadata
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
Workflows for storing, finding, transferring (non-)processed data


- DataLad can handle retrieval and linking
- Reliant on tagging
                    </textarea>
                </section>
                
                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
Storing & sharing very large files (>100 GB)

(e.g. images of cleared brains can take 250 GB per brain)


Infrastructural aspect
- CRC proposal: infrastructure already in place
  - Sciebo (user quota limit)
  - Dracoon (single file size limit, slow)
  - ...
- Talk to the local IT about solutions


Software aspect
- Files can be chunked (broken up)
- That often helps internet transfer anyway
- Different ways
  - DataLad / git-annex
    ```zsh
    git annex initremote ... chunk=100mb ...
    ```
  - domain-specific file format / data structure
    (e.g. OME-TIFF & BIDS)
    ```txt
    sub-01_sample-01_chunk-02_CONF.ome.tif
    ```
  - with generic software (e.g. 7zip)
                    </textarea>
                </section>

                <section data-markdown>
                    <textarea data-template>
## Action items
                    </textarea>
                </section>

                <section data-markdown data-separator-vertical="^\n\n">
                    <textarea data-template>
### Task: publication catalog from Dracoon

- Create a dataset (folder):
  - Project description (title, people, abstract) - `CITATION.cff`
  - Publications info - `RIS` or PubMed .`nbib` file(s)
- Push the dataset to Dracoon (ukk-cloud) in export mode
- Share your Dracoon project folder with INF and Z01

We will create a catalog based on these data.


#### CITATION.cff
```yaml
# This CITATION.cff file was generated with cffinit.
# Visit https://bit.ly/cffinit to generate yours today!

cff-version: 1.2.0
title: 'INF: Data Management for Computational Modelling'
message: This is our project description
type: dataset
authors:
  - given-names: Michael
    family-names: Hanke
    affiliation: 'INM-7, Forschungszentrum Jülich'
    orcid: 'https://orcid.org/0000-0003-3456-2493'
  - given-names: Michał
    family-names: Szczepanik
    affiliation: 'INM-7, Forschungszentrum Jülich'
    orcid: 'https://orcid.org/0000-0002-4028-2087'
abstract: >-
  This project will provide expertise for access,
  description, and modelling of the data collected in
  the individual projects as well as Z02 and Z03. INF
  will continuously assess general workflows,
  resource requirements, and data analysis processes
  to capture between-project differences that may
  impact data comparability and re-usability across
  projects. INF will provide tools, services and
  training to help projects align their research
  output to (i) facilitate data analysis for
  extracting common activity patterns and mechanisms
  underlying motor behaviours across species, and
  (ii) promote data-driven computational modelling.
```
https://citation-file-format.github.io/


#### RIS / PubMed 

![Citation export](images/pi-workshop/export-citation.png)


#### Publishing to Dracoon

- Instructions at [rdm.sfb1451.de/webdav/](https://rdm.sfb1451.de/webdav/)

```zsh
datalad create-sibling-webdav \
  --dataset . \
  --name dracoon \
  --mode filetree \
  https://daten.ukk-cloud.de/webdav/Neuro-CRC1451/INF/project-dataset
datalad push --to dracoon
```


Detailed walkthrough:

https://rdm.sfb1451.de/publication-catalog/

                    </textarea>
                </section>
            </div>
        </div>
        
        <script src="reveal.js/dist/reveal.js"></script>
        <script src="reveal.js/plugin/notes/notes.js"></script>
        <script src="reveal.js/plugin/markdown/markdown.js"></script>
        <script src="reveal.js/plugin/highlight/highlight.js"></script>
        <script>
         // More info about initialization & config:
         // - https://revealjs.com/initialization/
         // - https://revealjs.com/config/
         Reveal.initialize({
             hash: true,
             
             // Learn about plugins: https://revealjs.com/plugins/
             plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
         });
        </script>

    </body>
</html>

<!-- Local Variables: -->
<!-- indent-tabs-mode: nil -->
<!-- End: -->
